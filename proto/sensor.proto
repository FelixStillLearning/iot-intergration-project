syntax = "proto3";

package iot;
//service definition untuk gateaway
service SensorService {
  // 1. Unary: Kirim satu data, terima satu respon
  rpc SendSensorData (SensorRequest) returns (SensorResponse);

  // 2. Client Streaming: Kirim banyak data, terima satu ringkasan
  rpc StreamSensorData (stream SensorRequest) returns (SensorResponse);

  // 3. Server Streaming: Kirim satu perintah, terima data kontinu
  rpc MonitorSensor (SensorRequest) returns (stream SensorResponse);

  // 4. Bidirectional: Komunikasi dua arah real-time
  rpc InteractiveSensor (stream SensorRequest) returns (stream SensorResponse);
}

message SensorRequest {
    int32 sensor_id = 1;
    string sensor_name = 2;
    double temperature = 3;
    double humidity = 4;
    double pressure = 5;
    double light_intensity = 6;
    //waktu data sensor didapat kapan
    int64 timestamp = 7;
    string location = 8;
}

message SensorResponse {
    bool success = 1;    
    string message = 2;
    //lamanya waktu data di proses
    int64 processed_timestamp = 3;
}