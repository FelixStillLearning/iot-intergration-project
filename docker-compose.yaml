services:
  # Service Utama: IoT Bridge (gRPC + WebSocket + DDS RTPS)
  iot-bridge:
    build: 
      context: .
      dockerfile: Dockerfile
    image: iot-bridge-app:v1.0
    container_name: iot_bridge_container
    env_file:
      - .env
    ports:
      - "${GRPC_PORT}:${GRPC_PORT}"
      - "${WS_PORT}:${WS_PORT}"
    environment:
      - GRPC_HOST=${GRPC_HOST}
      - GRPC_PORT=${GRPC_PORT}
      - WS_PORT=${WS_PORT}
      - DDS_DOMAIN=${DDS_DOMAIN}
      - LOG_LEVEL=${LOG_LEVEL}
      - DDS_CONFIG_FILE=${DDS_CONFIG_FILE}
      - TEST_TOPIC=${TEST_TOPIC}
    networks:
      - iot-internal-network
    restart: always

networks:
  iot-internal-network:
    driver: bridge